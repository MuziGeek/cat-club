# /dev-summary - 开发进度总结

自动分析本次开发会话的工作内容，生成结构化的开发日志并追加到 `docs/09-development-progress.md`。

## 使用方式

```bash
/dev-summary                        # 总结当前开发进度
/dev-summary --feature "功能名称"    # 指定功能名称
/dev-summary --dry-run              # 仅预览，不写入文件
```

## 执行步骤

### Step 1: 收集开发信息

分析以下内容：

1. **Git 变更**（未提交的文件）
   ```bash
   git status --short
   git diff --stat
   ```

2. **新增文件**
   ```bash
   git status --porcelain | grep "^??" | cut -c4-
   git status --porcelain | grep "^A" | cut -c4-
   ```

3. **修改文件**
   ```bash
   git status --porcelain | grep "^M\|^ M" | cut -c4-
   ```

4. **当前日期**
   ```bash
   date "+%Y-%m-%d %H:%M"
   ```

### Step 2: 分析变更内容

对每个变更文件进行分类：

| 文件路径模式 | 分类 |
|-------------|------|
| `lib/providers/*.dart` | Provider 层 |
| `lib/services/*.dart` | Service 层 |
| `lib/data/models/*.dart` | 数据模型 |
| `lib/presentation/pages/**/*.dart` | 页面 |
| `lib/presentation/widgets/**/*.dart` | 组件 |
| `lib/core/**/*.dart` | 核心工具 |
| `android/**/*` | Android 配置 |
| `ios/**/*` | iOS 配置 |
| `pubspec.yaml` | 依赖配置 |
| `docs/**/*` | 文档 |

### Step 3: 生成日志结构

使用以下模板生成开发日志：

```markdown
## {日期} 开发日志（{功能名称}）

### 概述

{一句话描述本次开发完成的主要工作}

### 完成事项

#### Phase N: {阶段名称} ✅

| 任务 | 详情 | 状态 |
|------|------|------|
| {任务名} | {描述} | ✅ / ⏸️ / ❌ |

**新增文件：**
- `{文件路径}` - {用途说明}

**修改文件：**
- `{文件路径}` - {修改说明}

### 新增/修改文件清单

| 操作 | 文件路径 | 说明 |
|------|----------|------|
| 新建 | `{path}` | {description} |
| 修改 | `{path}` | {description} |

### 功能状态总结

| 功能 | 状态 | 说明 |
|------|------|------|
| {功能名} | ✅ 完成 / ⏸️ 暂停 / ❌ 未完成 | {说明} |

### 已知问题（可选）

{如有未解决的问题或限制，在此说明}

### 后续计划（可选）

| 优先级 | 任务 | 说明 |
|--------|------|------|
| P1 | {任务} | {说明} |

---
```

### Step 4: 更新文档

1. **读取** `docs/09-development-progress.md`
2. **更新** 文档头部的"最后更新"时间
3. **插入** 新的日志条目（在第一个 `## 202X-XX-XX` 之前）
4. **写入** 更新后的文档

### Step 5: 输出总结

向用户展示：
- 本次开发的功能概述
- 新增/修改的文件数量
- 功能完成状态
- 文档更新确认

## 状态标记说明

| 标记 | 含义 |
|------|------|
| ✅ | 已完成 |
| ⏸️ | 暂停/待定 |
| ❌ | 未完成/失败 |
| 🔄 | 进行中 |
| ⚠️ | 有问题需注意 |

## 示例输出

```
📝 开发进度已更新

日期：2026-02-03 16:30
功能：照片上传功能

📊 变更统计：
- 新增文件：3 个
- 修改文件：6 个
- 功能状态：部分完成（上传功能暂停）

📁 文档位置：
docs/09-development-progress.md

✅ 总结完成！
```

## 注意事项

1. **在功能开发完成后调用**，确保所有代码变更已完成
2. **未提交的变更也会被分析**，无需先 commit
3. **自动检测功能名称**，也可通过 `--feature` 手动指定
4. **追加模式**，不会覆盖历史记录
5. **中文输出**，与项目文档风格一致
